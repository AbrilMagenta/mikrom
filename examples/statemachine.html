<!doctype html>
<html>
  <head>
    <title>Basic Mikrom</title>
  </head>
  <body>
    <div class="menu">
      <a href="javascript:;" state-href="index">Index</a>
      <a href="javascript:;" state-href="about">About</a>
      <a href="javascript:;" state-href="buy">Buy</a>
    </div>
    
    <div state-if="loggedIn">
      Welcome, you are logged in!
    </div>
    
    <div state-if="page=='index'">
      This is visible on state "index"
    </div>
    <div state-if="page=='about'">
      About!
    </div>
    <div state-if="page=='buy'">
      Where to buy!
    </div>
    
    <a href="javascript:;" state-set="loggedIn=true" state-if="!loggedIn">Log in!</a>
    <a href="javascript:;" state-set="loggedIn=false" state-if="loggedIn">Log out!</a>
    
    <script src="../dist/mikrom.js"></script>
    <script>
      function AppState() {
        this.page = null;
      }
      AppState.prototype.refresh = function() {
        var e = document.createEvent("Event");
        e.initEvent("state.change");
        window.dispatchEvent(e);
      }
      AppState.prototype.changeTo = function(page) {
        this.page = page;
        this.refresh();
      }
      
      var appState = new AppState();
      
      mikrom.component("[state-href]", function(attr) {
        this.addEventListener("click", function() {
          appState.changeTo(attr.stateHref);
        })
      });
      
      mikrom.component("[state-set]", function(attr) {
        this.addEventListener("click", function() {
          with(appState) {
            eval(attr.stateSet);
          }
          appState.refresh();
        })
      });
      
      mikrom.component("[state-if]", function(attr) {
        var el = this;
        
        window.addEventListener("state.change", function() {
          with(appState) {
            if (eval(attr.stateIf)) {
              el.style.display = "block";
            }else{
              el.style.display = "none";
            }
          }
        })
      })
      
      // Initialize components
      mikrom.init();
      appState.loggedIn = false;
      appState.changeTo("index");
    </script>
  </body>
</html>